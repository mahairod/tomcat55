================================================================================
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
================================================================================

$Id$

                         =================================
                         Apache Tomcat 5.5 Patch Proposals
                         =================================


PATCHES PROPOSED TO BACKPORT:
  [ New proposals should be added at the end of the list ]

* Multiple improvements to the Windows Installer
  - https://issues.apache.org/bugzilla/show_bug.cgi?id=33262
    Install monitor to auto-start for current user only rather than all users to
    be consistent with menu item creation.
  - Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=40510
    Provide an option to install shortcuts for the current user or all users.
    Also ensure registry is correctly cleaned on uninstall for 64-bit platforms.
  - Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50949
    Provide the ability to specify the AJP port and service name when installing
    Tomcat using the Windows installer. This permits multiple instances of the
    same Tomcat version to be installed side-by-side.
  - Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51135
    Fix auto-detection of JAVA_HOME for 64-bit Windows platforms that only have
    a 32-bit JVM installed.
  http://people.apache.org/~markt/patches/2011-08-22-windows-installer-tc55.patch
  Plus
    svn rm build/resources/confinstall/server_1.xml
    svn rm build/resources/confinstall/server_2.xml
    svn rm build/resources/tickno.bmp
    svn rm build/resources/tickyes.bmp
    svn rm build/resources/main.ico
    svn rm build/resources/uninst.ico
  +1: markt, jim, kkolinko
  -1:
    kkolinko: Noted a typo in a message displayed by uninstaller:
     s/with -serviceName/with -ServiceName/

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51550
  Display error page rather than an empty response for an IllegalStateException
  https://issues.apache.org/bugzilla/attachment.cgi?id=27421
  +1: markt
  -0: kkolinko: I do not like removing the catch from CoyoteAdapter. It
      looks safer the old way. JkCoyoteHandler does not handle Errors, just
      Exceptions. It seems from the patch that all you need to fix this bug is
        ep.setStatus(MsgContext.JK_STATUS_ERROR);
      Can't it be done by CoyoteAdapter itself?
        markt: In short, no. To correctly handle the error the associated
               processor needs to set the error flag and catching the exception
               in the CoyoteAdaptor prevents that. The processors catch
               Throwable so nothing extra will slip through.
               The JkCoyoteHandler is a special case since it is a completely
               different implementation. However, JkCoyoteHandler does need to
               be changed to catch Throwable rather than Exception. I have
               updated the proposed patch to do exactly that.
  -0: schultz: I tend to agree with Konstantin's assertion that the catch
      block is important. I understand the change to the status, but could
      you explain why the catch(Throwable) block has been removed?
        markt: See reply to kkolino above.

  -1:
