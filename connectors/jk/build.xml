<project name="jk" default="build-main" basedir=".">

    <!-- ===================== Initialize Property Values =================== -->
    <property name="tomcat4.home" value="../../jakarta-tomcat-4.0/build"/>
    <property name="servletapi.home"   value="../../jakarta-servletapi-4/dist"/>
    <property name="tomcat-util.home" value="../util/build"/>
    
    <property name="catalina.jar" value="${tomcat4.home}/server/lib/catalina.jar"/>
    <property name="servlet.jar" value="${servletapi.home}/lib/servlet.jar"/>
    <property name="tomcat-util.jar" value="${tomcat-util.home}/lib/tomcat-util.jar"/>

    <property name="jk.build" value="${basedir}/build"/>

    <target name="build-prepare">
        <mkdir dir="${jk.build}"/>
	<mkdir dir="${jk.build}/classes"/>
	<mkdir dir="${jk.build}/lib"/>
    </target>

    <target name="build-main" depends="build-prepare">
    
        <javac srcdir="src/java"
	       destdir="${jk.build}/classes"
	       classpath="${tomcat-util.jar}:${catalina.jar}:${servlet.jar}"
	       deprecation="on"
	       debug="on"
	       optimize="off"
	       verbose="off"
	       excludes="**/CVS/**">
	    <exclude name="org/apache/ajp/tomcat4/**" if="tomcat4.skip"/>
	</javac>

	<!-- Copy static resource files -->
	<copy todir="${jk.build}/classes">
	    <fileset dir="src/java">
	    	<include name="**/*.properties"/>
	    </fileset>
        </copy>

	<jar jarfile="${jk.build}/lib/ajp.jar"
	     basedir="${jk.build}/classes"
	     />
    </target>

    <!-- ================ BUILD: Create Jk Javadocs =================== -->
    <target name="javadoc">
        <delete dir="${jk.build}/javadoc"/>
	<mkdir dir="${jk.build}/javadoc"/>
	<javadoc packagenames="org.apache.tomcat.util.*"
               sourcepath="src/java"
                  destdir="${jk.build}/javadoc"
                   author="true"
                  version="true"
              windowtitle="Jk Connector Documentation"
                 doctitle="Jk Connector"
                   bottom="Copyright &#169; 2001 Apache Software Foundation.  All Rights Reserved."
	/>
    </target>


    <target name="clean">
        <delete dir="${jk.build}"/>
    </target>
</project>
