#
# Copyright 1999-2004 The Apache Software Foundation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# @author  Pier Fumagalli <mailto:pier@betaversion.org>
# @version $Id$

.SUFFIXES: .c .o .lo

# Building tools
CC      = @CC@
CPP     = @CPP@
SHELL   = @SHELL@
LIBTOOL = @LIBTOOL@
INSTALL = $(SHELL) $(SRC_DIR)/support/install.sh -c
APXS    = @APXS@

# Build flags
CPPFLAGS = @CPPFLAGS@
CFLAGS   = @CFLAGS@
LDFLAGS  = @LDFLAGS@
INCLUDES = @INCLUDES@

# Extra build flags
EXTRA_CPPFLAGS = @EXTRA_CPPFLAGS@
EXTRA_CFLAGS   = @EXTRA_CFLAGS@
EXTRA_LDFLAGS  = @EXTRA_LDFLAGS@
EXTRA_INCLUDES = @EXTRA_INCLUDES@

# apr library name
APR_LIBNAME = @APR_LIBNAME@
APR_LIB = @APR_LIB@

# Module to build
MODULE = @MODULE@

# Directories location
APR_DIR = @APR_DIR@
SRC_DIR = @SRC_DIR@
TGT_DIR = @TGT_DIR@
BLD_DIR = $(TGT_DIR)/build
OBJ_DIR = $(BLD_DIR)/objs
LIB_DIR = $(BLD_DIR)/libs
DOC_DIR = $(BLD_DIR)/docs
API_DIR = $(DOC_DIR)/api-c

# Distribution file names
TARBALL = webapp-module-$(WEBAPP_VERSION)
MODFILE = mod_webapp.so

# Related tools used in the build process
PERL        = @PERL@
ANT         = @ANT@
ANT_TARGETS = @ANT_TARGETS@

# Versions
APACHE_VERSION = @APACHE_VERSION@
WEBAPP_VERSION = @WEBAPP_VERSION@
HOST           = @HOST@
DATE           = @DATE@

# Compilation template
%.lo: $(LOCAL_SRC_DIR)/%.c 
	$(LIBTOOL) --mode=compile \
	  $(CC) -c $< -o $@ \
	    $(INCLUDES) \
	    $(CPPFLAGS) \
	    $(CFLAGS) 
	$(LIBTOOL) --mode=install \
	  $(INSTALL) \
	    $@ \
	    $(OBJ_DIR)
