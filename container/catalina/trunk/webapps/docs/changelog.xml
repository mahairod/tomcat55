<?xml version="1.0"?>
<!DOCTYPE document [
  <!ENTITY project SYSTEM "project.xml">
]>
<document url="changelog.html">

  &project;

  <properties>
    <author email="remm@apache.org">Remy Maucherat</author>
    <title>Changelog</title>
  </properties>

<body>

<section name="Tomcat 5.0.10 (remm)">

  <subsection name="General">

    <changelog>

      <update>
      JSP 2.0 specification updates, submitted by Mark Roth (kinman)
      </update>
      <update>
      Servlet 2.4 schema update, submitted by Yutaka Yoshida (jfarcand)
      </update>
      <update>
      Get ready for using JSR 160 RI (JMX Remote 1.0): copy additional, 
      optional, JMX binaries (remm)
      </update>
      <update>
      Replace MX4J 1.1.1 with the Sun JMX 1.2 RI (remm)
      </update>
      <scode>
      Major update to Japanese internationalization, submitted by 
      Kazuhiro Kazama (remm)
      </scode>
      <fix>
      Fix bad imports (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Catalina">

    <changelog>

      <add>
      Add sessions and serverinfo tasks, submitted by Vivek Chopra (remm)
      </add>
      <fix>
      Minor optimization: Avoid scanning duplicate JARs for TLDs (luehe)
      </fix>
      <update>
      Expose the new connector properties in JMX (amyroh)
      </update>
      <fix>
      Big JDBCRealm cleanup: fix for <bug>7116</bug>, <bug>10623</bug>,
      <bug>11929</bug>, <bug>8091</bug>, and make authenticate synchronized 
      since there are race conditions between the connection being opened, 
      used and exceptions occuring (funkman)
      </fix>
      <fix>
      Simplifying the code by hiding the arrayCopy (billbarker)
      </fix>
      <fix>
      <bug>22691</bug>: Wrap getCanonicalFile in a try/catch (remm)
      </fix>
      <fix>
      Reenable validation, using Xerces 2.1 instead of Xerces 2.5 (remm)
      </fix>
      <fix>
      <bug>22698</bug>: Restore RealmBase.main(), allowing to compute digests
      (remm)
      </fix>
      <fix>
      <bug>22546</bug>: Fix small filter extension mapping bug, where if the 
      extension of the request starts with the tested path, it would have 
      been matched (remm)
      </fix>
      <fix>
      <bug>22695</bug>: don't check for session validity when activating and 
      passivating (remm)
      </fix>
      <fix>
      Do not create a new Subject everytime a Servlet/Filter is invoked, 
      associate the same Subject to the AccessControlContext (jfarcand)
      </fix>
      <update>
      When saving server.xml, don't save the value of properties which have 
      their default values (remm)
      </update>
      <fix>
      Release all logs associated with this CL when stopping the CL, and avoid
      NPE in toString after stop (remm)
      </fix>
      <fix>
      Avoid references leak: ckean up and recycle all thread local resources, 
      and reset the context CL after invoking the pipeline (remm)
      </fix>
      <fix>
      The request dispatcher should also not log a client abort exception
      (remm)
      </fix>
      <fix>
      When saving server.xml, don't print the className if it's one of the 
      standard implementations, and add some fields to the exception list
      (remm)
      </fix>
      <fix>
      Null out the reference to the resources when stopping the classloader
      (remm)
      </fix>
      <fix>
      Don't save the config file attribute, as it is always useless, and don't
      indent context confug files (remm)
      </fix>
      <update>
      Allow overriding the Host's unpackWARs using a new unpackWAR attribute on
      the Context element (remm)
      </update>
      <fix>
      Include the patInfo when a relative path is used to get a request 
      dispatcher, submitted by Mark Thomas (remm)
      </fix>
      <fix>
      <bug>20029</bug>: fix "-force" shell script parameter handling, submitted
      by Christian Brensing (remm)
      </fix>
      <fix>
      Deploy descriptors even if deployOnStartup is false, as they should be 
      considered as if they were part of server.xml (remm)
      </fix>
      <fix>
      Apply patch for <bug>22857</bug> and <bug>22858</bug> to CGI servlet, 
      submitted by Mark Thomas (amyroh)
      </fix>
      <fix>
      Get the absolute path to the work dir, so that JARs in /WEB-INF/lib can 
      be found when using non filesystem based resources (luehe)
      </fix>
      <fix>
      XML-escape the values when writing out the tomcat-users.xml file, 
      submitted by Mark Thomas (billbarker)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Cluster">

    <changelog>

      <fix>
      Set dirty flag gets set on setMaxInactiveInterval (fhanik)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Coyote">

    <changelog>

      <fix>
      Also consider last element in comma-separated protocols list, or the 
      case where the list contains a single element and no commas (luehe)
      </fix>
      <fix>
      Implement getAttribute(key) in the protocol (amyroh)
      </fix>
      <fix>
      Make certain that we are still in an https session before looking for 
      certs, submitted by Mark Thomas (billbarker)
      </fix>
      <fix>
      Adding accessors so that the JkCoyote connectors can play nice with the 
      admin webapp (billbarker)
      </fix>
      <fix>
      Fix parsing of the content-type header in Response (luehe)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Jasper">

    <changelog>

      <fix>
      When an error occurs, get the file name from path instead of from the
      exception (kinman)
      </fix>
      <fix>
      Don't generate code to do an instanceof when it can be done at
      translation time (kinman)
      </fix>
      <fix>
      Avoid defining multiple getServletInfo() methods (one for each page
      directive with an 'info' attribute) (luehe)
      </fix>
      <fix>
      Supply taglib's unique id (instead of the value of the uri argument in
      the directive) to the TagLibraryValidator's validate method (luehe)
      </fix>
      <fix>
      Ensure that &lt;jsp:root&gt; is root element in JSP document (luehe)
      </fix>
      <fix>
      Prepend "urn:jsptld" to uri values that represent relative paths
      when adding "xmlns:prefix" attribute on the root of the JSP document's
      XML view (see JSP.10.1.5), and make the value passed as the uri argument
      to TagLibraryValidator.validate() match the above (luehe)
      </fix>
      <fix>
      When precompiling with JSPC, files that mathch the url-pattern specified
      in jsp-config should be included for compilation (kinman)
      </fix>
      <update>
      Added support for JSP.6.2.4: fix issues with DOCTYPE validation (luehe)
      </update>
      <fix>
      Don't combine LineInfos from different files (ecarmich)
      </fix>
      <fix>
      Set Node.startMark correctly in JSP document nodes created from 
      character data: this fixes incorrect SMAPping of template text nodes 
      containing line feeds, and incorrect error reporting for unparseable EL 
      expression nodes (ecarmich)
      </fix>
      <fix>
      JSP error page mechanism fails intermittently to display contents of 
      error page, which occurred when a JSP was using a custom page context
      (luehe)
      </fix>
      <fix>
      Use just the class name if package is imported, and in tag files, 
      declare request as HttpServletRequest and response HttpServletResponse, 
      as is the case in servlets (kinman)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Webapps">

    <changelog>

      <docs>
      The Loader does not have a method to set a work dir, remove from docs
      (glenn)
      </docs>
      <fix>
      Update the host properties in admin (amyroh)
      </fix>
      <update>
      Update admin with the latest connector changes, including thread pool
      configuration (amyroh)
      </update>
      <fix>
      Fix to return null when an error response is sent, submitted by 
      Jeff Tulley (amyroh)
      </fix>
      <fix>
      Get rid of the maximum size of the username and password fields (amyroh)
      </fix>
      <fix>
      <bug>22268</bug>: allow using SHA digest (amyroh)
      </fix>
      <fix>
      In the default page, update links to the lists, and add a link to the 
      open bugs (remm)
      </fix>
      <docs>
      Update for changes to jsvc from commons-daemon (remm)
      </docs>
      <add>
      Refactor the status servlet, allowing for XML output in addition to the 
      user friendly HTML, submitted by Peter Lin, based on code from John
      Turner (remm)
      </add>
      <update>
      Implement the XML processor state status (remm)
      </update>
      <docs>
      Update classloader documentation according to the current behavior (remm)
      </docs>

    </changelog>

  </subsection>

  <subsection name="Deployer">

    <changelog>

      <fix>
      In validator task, set the context classloader to avoid issues with
      commons-logging (remm)
      </fix>
      <fix>
      Validate before running javac (remm)
      </fix>

    </changelog>

  </subsection>

</section>

<section name="Tomcat 5.0.9 (remm)">

  <subsection name="Catalina">

    <changelog>

      <fix>
      Fix bug where no static resource over 512 bytes would get cached 
      by default (remm)
      </fix>
      <fix>
      Ensure uniqueness of patterns across all servlets, so that it is possible
      to reliably override the servlets defined in the default configuration
      (remm)
      </fix>
      <fix>
      Fix and improve static resource cache space allocation algorithm (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Coyote">

    <changelog>

      <fix>
      Revert a patch on CoyoteConnector causing a performance regression (remm)
      </fix>
      <fix>
      When mapping to the default servlet, or mapping to a physical welcome 
      file, String representation of the path is available, which saves some
      object creation (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Jasper">

    <changelog>

      <fix>
      Disable tag pooling when a JSP uses "extends", to avoid NPE when the pool
      was accessed (luehe)
      </fix>

    </changelog>

  </subsection>

</section>

<section name="Tomcat 5.0.8 (remm)">

  <subsection name="General">

    <changelog>

      <fix>
      Update commons-daemon packaging for consistency and ease of use on Unix
      (remm)
      </fix>
      <update>
      Servlet specification updates, submitted by Yutaka Yoshida (jfarcand)
      </update>
      <update>
      JSP specification updates, submitted by Mark Roth (kinman)
      </update>
      <fix>
      <bug>22494</bug>: Removed logVerbosityLevel doc and init-param from 
      JSP Servlet, as they're no longer used, submitted by Eric Carmichael
      (yoavs)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Catalina">

    <changelog>

      <fix>
      Remove some stack trace dumping in MapperListener (remm)
      </fix>
      <fix>
      Remove extra setLogger call in Embedded.createContext (remm)
      </fix>
      <update>
      Add support for TLD validation, and fix bug <bug>21917</bug> where
      entities couldn't be resolved in a TLD (jfarcand)
      </update>
      <fix>
      Fixed logic so that iterator actually gets cloned when "clone" is set to
      true, and replace LinkedList with ArrayList (luehe)
      </fix>
      <fix>
      Avoid NPE when ensuring that resource path starts with '/' (luehe)
      </fix>
      <fix>
      Avoid reformatting constant Expires header on every request (luehe)
      </fix>
      <fix>
      Log client abort exceptions as debug information (remm)
      </fix>
      <fix>
      Found a way to avoid the extra restart caused by the web.xml tracker, 
      when the webapp was deployed by an outside source, such as the manager
      servlet (remm)
      </fix>
      <fix>
      Improve CL stopped error message, so that it is more explanatory (remm)
      </fix>
      <fix>
      When using the deployer, schema validation wasn't supported (remm)
      </fix>
      <fix>
      Fix NPE when getMessage of an exception returns null in the 
      DefaultServlet (jfarcand)
      </fix>
      <fix>
      Fix behavior of HttpSession.setMaxInactiveInterval() (luehe)
      </fix>
      <fix>
      Cleanup of the XML descriptors for the model MBeans, removing old 
      connectors and old attributes (remm)
      </fix>
      <update>
      Update the store and persistent manager code so that both will use the
      container provided background processing thread, rather than using one
      thread per component (as much as two threads per context) (remm)
      </update>
      <add>
      Add new managerChecksFrequency attribute to StandardContext, allowing to
      configure how often the manager session expiration and passivation 
      checks will be called, similar to the intervals used in Tomcat 4.1.x 
      (remm)
      </add>
      <fix>
      Disable schema validation for now, due to persistent issues with Xerces
      (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Coyote">

    <changelog>

      <update>
      Added support for specifying alias name for server keypair and cert
      chain, to be used by the server to authenticate itself to SSL clients
      (luehe)
      </update>
      <update>
      Added support for specifying comma-separated list of SSL protocol
      variants to be enabled, which may be useful to disable the less secure 
      SSLv2 (luehe)
      </update>
      <fix>
      Fixed bug in CoyoteConnector getter methods for SSL related attributes, 
      which would always return null if SSL properties were configured 
      directly on the Connector element (instead of its nested and now 
      deprecated Factory element) (luehe)
      </fix>
      <update>
      Moving the new protocols logic to the 14 Factory (billbarker)
      </update>
      <fix>
      Clone request attribute names iterator (luehe)
      </fix>
      <fix>
      Fix client abort logging, and throw a client abort when an IOException 
      occurs when writing bytes (remm)
      </fix>
      <fix>
      Avoid a NPE when requesting the remote address between requests or before
      processing any request (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Jasper">

    <changelog>

      <update>
      Allow a taglib to be defined more than once in taglib directives, even in
      statically included files, and remove need for keeping a Stack for 
      prefix bookkeeping (kinman)
      </update>
      <fix>
      When including a JSP document (written in the XML syntax), in the 
      resulting XML View of the translation unit the root element of 
      the included segment must have the default namespace reset to "" (kinman)
      </fix>
      <fix>
      Don't merge SMAP entries in the outputStartLines aren't consecutive,
      which fixes IllegalArgumentException when SMAPs are generated (remm)
      </fix>
      <fix>
      Replaced JSPC error message with localizable error code (luehe)
      </fix>
      <update>
      Added -classpath option to JspC (luehe)
      </update>
      <fix>
      Beautify the insertion of the XML fragment in JSPC (remm)
      </fix>
      <fix>
      Restoring JVM 1.3.x compatibility to Jasper, with a new split String
      method (billbarker)
      </fix>
      <fix>
      Add attibutes doctype-root-element, doctype-system and doctype-public
      to &lt;jsp:output&gt; for outputing a DOCTYPE declaration in XML 
      documents, per latest spec change (kinman)
      </fix>
      <fix>
      Fixed buffer realloc when writing single char (luehe)
      </fix>
      <fix>
      Spec has been changed to allow for include-prelude and include-coda in
      jsp-config (kinman)
      </fix>
      <fix>
      Restored JSP default for 1.2 based tag handlers (luehe)
      </fix>
      <fix>
      Adjust Java lines mappings for codes that are generated in buffers
      (kinman)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Webapps">

    <changelog>

      <update>
      Add two JMX related tasks, designed to use the jmxproxy servlet, 
      submitted by Vivek Chopra (remm)
      </update>
      <docs>
      Document usage of commons-daemon with Tomcat on Unix (remm)
      </docs>
      <update>
      Add new JSP XML test in the tester, and fix the one that was already
      there (remm)
      </update>
      <fix>
      The tester should handle i18ned manager reload messages (remm)
      </fix>

    </changelog>

  </subsection>

</section>

<section name="Tomcat 5.0.7 (remm)">

  <subsection name="General">

    <changelog>

      <scode>
      Tomcat 5.0.x release plan was voted (remm)
      </scode>
      <update>
      Various JSP 2.0 API updates, submitted by Mark Roth (kinman)
      </update>
      <update>
      Update to commons-modeler 1.1, submitted by Yoav Shapira (remm)
      </update>
      <update>
      Simplify the use of the Ant script shipped in the embedded package (remm)
      </update>
      <update>
      Bundle Xerces 2.5.0 again, due to bugs in Crimson (remm)
      </update>

    </changelog>

  </subsection>

  <subsection name="Catalina">

    <changelog>

      <update>
      Allow putting a /META-INF/context.xml inside any WAR file deployed
      by the HostConfig (remm)
      </update>
      <fix>
      Many bugfixes in JNDI realm: <bug>18698</bug>, <bug>11678</bug>,
      <bug>19864</bug>, <bug>20518</bug>, with help from David DeWolf and
      Jeff Tulley (funkman)
      </fix>
      <fix>
      Fix for three related request dispatcher bugs, including 
      <bug>22013</bug>, <bug>4690</bug> (cross context sessions support), and
      port the fix for ServletContext.getContext(...) when using the root 
      context (remm)
      </fix>
      <update>
      Use PropertyUtils to obtain the rootCause. This way we can
      also drill into nested JspExceptions or another Throwable object
      which has a 'rootCause' property which returns a Throwable (funkman)
      </update>
      <update>
      Extract all non class resources from a JAR on access to a non class
      resource (remm)
      </update>
      <fix>
      <bug>14817</bug>: JNDIRealm SHA digest implementation incorrect (funkman)
      </fix>
      <fix>
      NPE when an invalid web.xml is deployed and the digester throws
      an exception (jfarcand)
      </fix>
      <fix>
      <bug>22236</bug>: addAttributeValues may return null, this could 
      trigger a NPE if debugging was turned up >=2 (funkman)
      </fix>
      <fix>
      <bug>22146</bug>: Use Class.forName instead of ClassLoader.loadClass
      (remm)
      </fix>
      <fix>
      Split the applicationListeners array in two, for performance reasons
      (remm)
      </fix>
      <fix>
      Fix bug where welcome files were not being processed in the embedded
      distribution (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Coyote">

    <changelog>

      <fix>
      <bug>9351</bug>: parsing IPv6 hostnames (in IP form, obviously),
      submitted by Masashi Yamaguchi (remm)
      </fix>
      <fix>
      Allow extending CoyoteConnector (jfarcand)
      </fix>
      <update>
      <bug>22192</bug>: the context mapping algorithm actually needs to be 
      similar to the algorithm used for widcard wrapper mapping; optimize 
      wildcard mapping: since the amount of nesting the mapping has is known, 
      some mapping operations can be avoided (remm)
      </update>
      <update>
      Allow for customization of JSSE trust and key managers (luehe)
      </update>
      <fix>
      Added check for (keystoreType == null) before calling 
      getKeyManagers/getTrustManagers (luehe)
      </fix>
      <fix>
      Use less aggressive socket timout reduction when the server load
      increases (remm)
      </fix>
      <fix>
      Fix calculation of a request processing time (it must not include the 
      time waiting for data in keepalive mode, or the time waiting for data 
      for an initial request on a connection) (remm)
      </fix>
      <fix>
      Fixing CoyoteConnector getters for JMX; CoyoteConnector will now rely
      on the protocol handler for most of the values it returns (billbarker)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Jasper">

    <changelog>

      <fix>
      <bug>22090</bug>: Enable expression cache, submitted by Matthias Ernst
      (remm)
      </fix>
      <fix>
      <bug>22103</bug>: Release servlet writer after compilation, submitted by
      Gilles Scokart (remm)
      </fix>
      <fix>
      <bug>21206</bug>: Fix including a JSP, where Jasper would do weird 
      things whenever the outer request had a non null pathInfo; it will now 
      use the included servlet path correctly (remm)
      </fix>
      <fix>
      Have 'isELIgnored' page directive attribute take precedence over JSP
      config el-ignored (luehe)
      </fix>
      <update>
      Replaced JspServlet's "tagPoolSize" config param with the correct
      "tagpoolMaxSize" in web.xml, and removed getTagPoolSize() from Options, 
      because tag pool size is no longer needed at compile time (luehe)
      </update>
      <update>
      Simplify the way the URLClassLoader used by JSPC gets initialized (luehe)
      </update>
      <fix>
      <bug>22133</bug>: workaround for a JDK 1.3 scoping bug, submitted by
      Matthias Ernst (remm)
      </fix>
      <docs>
      Added javadocs for getExtends methods (luehe)
      </docs>
      <update>
      Refactor some code in JspDocumentParser, since startPrefixMapping
      got called before startElement, turn on push/pop prefixes for taglibs 
      in XML syntax, so that proper prefix can be located (kinman)
      </update>
      <fix>
      Make JspFragment.getJspContext abstract (kinman)
      </fix>
      <update>
      JSPC will now display root cause for build errors; also fix a needed side
      effect in classpath generation when tag files must be compiled (remm)
      </update>
      <fix>
      In JspDocumentParser, pop is called in the same order as push, so 
      the Stack should be replaced by a LinkedList (remm)
      </fix>
      <fix>
      Replaced JSPC message with more meaningful warning (luehe)
      </fix>
      <fix>
      <bug>22266</bug>: keep template text together with mappedfile="true",
      submitted by Eric Carmichael (remm)
      </fix>
      <fix>
      <bug>22006</bug>: Invalid SMAP line entries when running with 
      mappedfile=true, submitted by Eric Carmichael (remm)
      </fix>
      <fix>
      Apply workaround for failure in optimizeLineSection() when there are 
      entries with an outputStartLine of 0, Submitted by Eric Carmichael (remm)
      </fix>
      <fix>
      The "out" in the Fragment helper functions is now JspWriter instead of
      java.io.Writer, so that it won't trigger errors when a fragment contains
      include actions (kinman)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Webapps">

    <changelog>

      <docs>
      Update the documentation to reflect the fact that the Factory element 
      is no longer required to setup a stand-alone SSL Connector (billbarker)
      </docs>
      <update>
      The status servlet will now also display wrapper mappings (remm)
      </update>
      <fix>
      Allow passing a regular path instead of an URL for the WAR to upload to
      the DeployTask; also pass the right URL String so that the "update" flag
      is no longer ignored (remm)
      </fix>
      <fix>
      Fixes to the manager servlet: cleanup URL handling, to be consistent 
      with the HTML manager; don't send extra "OK" messages; fix update flag;
      make sure configFile is null if there's no context XML file (remm)
      </fix>
      <fix>
      Fix webapp tagging and redeployment from a tag (remm)
      </fix>
      <fix>
      Display byte sizes and times using sensible units (KB and MB, s and ms)
      in the status servlet (remm)
      </fix>
      <fix>
      Display the remote host when in keepalive status, as well as the 
      elapsed time (it corresponds mostly to the amount of time since 
      the start of the previous request) (remm)
      </fix>

    </changelog>

  </subsection>

</section>

<section name="Tomcat 5.0.6 (remm)">

  <subsection name="General">

    <changelog>

      <update>
      Synchronize the server.xml used by the Windows installer with the main
      default server.xml (remm)
      </update>
      <update>
      Update to Xerces 2.5.0 (remm)
      </update>
      <update>
      Add additional information in the welcome HTML for the release download
      (remm)
      </update>
      <fix>
      <bug>21999</bug>: Typo fix, submitted by Liu Kang (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Catalina">

    <changelog>

      <update>
      Remove welcome file processing from the default servlet (funkman)
      </update>
      <fix>
      Search for TLDs in all subdirectories of WEB-INF, except classes and lib
      (luehe)
      </fix>
      <fix>
      Fix possible file descriptor leaks in the code responsible for unpacking
      a WAR (remm)
      </fix>
      <fix>
      <bug>21908</bug>: Fix Unix startup script bug (bad AS/400 condition),
      submitted by Jason Corley (funkman)
      </fix>
      <update>
      Remove useless casts in AccessLogValve (remm)
      </update>
      <fix>
      The default socket factory class name is now the Coyote factory (remm)
      </fix>
      <add>
      Add a new digester rule using the IntrospectionTools so that all 
      attributes are passed to the connector, including those which have no
      explicit setters (in which case the setProperty method is called) (remm)
      </add>
      <update>
      Simplify the connector configuration in server.xml (remm, billbarker)
      </update>
      <update>
      Expose the ServletWrapper statistics through JMX (remm)
      </update>
      <update>
      The connectors default configuration are now similar to the HTTPd 2.0
      default configuration, submitted by Henri Gomez (remm)
      </update>
      <update>
      Send JSR 77 spec required notifications for J2EE mbeans (amyroh)
      </update>
      <update>
      Put the CSS used by various Tomcat components in a separate class in the
      util package (remm)
      </update>
      <fix>
      Remove path normalization in the default servlet (remm)
      </fix>
      <fix>
      Copy jk2.properties to conf folder (remm)
      </fix>
      <fix>
      Remove some attributes from the default JK 2 configuration, which should
      instead be configured through jk2.properties (remm)
      </fix>
      <update>
      Remove unneeded fields in the CoyoteConnector (remm)
      </update>
      <fix>
      Make the SingleSignOn methods protected so it is possible to extend that
      class and have a customized version (jfarcand)
      </fix>
      <add>
      Add code allowing configuring the resource cache size for a context 
      (remm)
      </add>
      <update>
      Refactor extension handling; available and required extensions are now 
      consistently NULL if not present (luehe)
      </update>
      <fix>
      System resources were identified but then ignored when checking if 
      an app's dependencies could be resolved (luehe)
      </fix>
      <add>
      Add the sslProtocol property on the connector to define the protocol 
      used in SSL (luehe)
      </add>
      <update>
      Synchronize the startup scripts based on the Tomcat 4.1 code (funkman)
      </update>
      <fix>
      Close JarInputStream after reading manifest (luehe)
      </fix>
      <update>
      Use commons-logging and the existing StringManager in the extension
      validator (luehe)
      </update>
      <fix>
      <bug>22032</bug>: missing security-policy in default configuration;
      precompiled JSPs running under the security manager always have to 
      access org.apache.jasper.runtime.* classes (jfarcand)
      </fix>
      <update>
      Remove old reload code, now replaced with a simpler stop/start sequence
      (remm)
      </update>
      <fix>
      Tomcat will now ignore a non existent classpath JAR (remm)
      </fix>
      <fix>
      Some steps of start shouldn't be executed if the context startup has
      previously encountered errors (remm)
      </fix>
      <fix>
      Temporary fix for running SSL without a SocketFactory (billbarker)
      </fix>
      <scode>
      Remove apparently useless wrapper classes (remm)
      </scode>

    </changelog>

  </subsection>

  <subsection name="Coyote">

    <changelog>

      <fix>
      Fix welcome file mapping, so that the order of the welcomes specified in
      web.xml is respected, whereas previously servlet mapped welcomes would
      have a priority over physical welcome files (funkman)
      </fix>
      <fix>
      When shutting down the endpoint's server socket, close the unlocking
      socket inside a finally block (remm)
      </fix>
      <fix>
      Fix configuration of the maxThreads attribute of the thread pool (remm)
      </fix>
      <update>
      Add a new protocol attribute on the Coyote connector, which can be used 
      rather than using the protocol handler classname; acceptable values are
      either "HTTP/1.1" or "AJP/1.3" (remm)
      </update>
      <update>
      Improve the thread names and numbering, based on the associated 
      connector name and the number of existing threads, so that reading 
      a thread dump is significantly easier (remm)
      </update>
      <fix>
      Fix a bug redirecting to a folder: the context path was lost (remm)
      </fix>
      <fix>
      Fix incorrect URL normalization of the "///" sequence, due to a bad port
      of the String based algorithm to arrays (remm)
      </fix>
      <add>
      The HTTP/1.1 connector will now automatically scale down the timeout and
      disable connection keepalive should the server start getting low on 
      processors (remm)
      </add>
      <fix>
      Make certain that we tell Apache that we have finished with the request;
      If the Adapter throws an exception before entering the Pipeline, we end 
      up with both Apache and Tomcat trying to read the Channel and hence 
      not serving requests (billbarker)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Jasper">

    <changelog>

      <fix>
      <bug>21823</bug>: Compiler uses invoking page's PageInfo for
      handling tag files, submitted by Eric Carmichael (luehe)
      </fix>
      <fix>
      <bug>21978</bug>: Certain tag file pathnames lead to compile errors,
      submitted by Eric Carmichael; also add check for Java keywords in
      package names (kinman)
      </fix>
      <fix>
      Remove useless check if the security manager is not present (jfclere)
      </fix>
      <update>
      Refactor getDerivedPackageName and eliminate some duplicate code (kinman)
      </update>
      <fix>
      <bug>21168</bug>: Incorrect paths in generated SMAP file entries, 
      submitted Eric Carmichael (luehe)
      </fix>
      <fix>
      <bug>20155</bug>: The strutsel-exercise-taglib application can not 
      be compiled with jspc, because the correct class loader was not being
      set (kinman)
      </fix>
      <update>
      Make JspProperty constructor public, to allow for user supplied JspConfig
      (kinman)
      </update>
      <update>
      Removed unused methods and instance variables in Collector and PageInfo 
      (luehe)
      </update>
      <fix>
      <bug>22084</bug>: Fix incorrect indentation of generated code, submitted
      by Eric Carmichael (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Webapps">

    <changelog>

      <add>
      Display contexts and servlets stats in the status servlet, so that the
      administrator can get a complete view of the server (remm)
      </add>
      <update>
      Beautify the status servlet, and integrate it with the HTML manager, 
      through links (remm)
      </update>
      <fix>
      In the status servlet scoreboard, add missing whitespace between method 
      and URI (remm)
      </fix>
      <docs>
      Update the connectors documentation (remm)
      </docs>
      <docs>
      Manager, HTML manager and deployer docs update (remm)
      </docs>
      <docs>
      Document the background processing feature, and the configuration of the
      resource cache (remm)
      </docs>
      <fix>
      Add a legend for the status servlet scoreboard (remm)
      </fix>
      <fix>
      Fix typo in the Struts definition of the default context forms, submitted
      by Jeff Tulley (remm)
      </fix>
      <docs>
      Initialize filter so that the release notes of the docs look right
      (remm)
      </docs>

    </changelog>

  </subsection>

</section>

<section name="Tomcat 5.0.5 (remm)">

  <subsection name="General">

    <changelog>

      <add>
      Update the tester web application for Tomcat 5, and make a tester run
      part of the release process (remm)
      </add>
      <fix>
      In the checkout target, only checkout modeler from commons instead 
      of all of commons (funkman)
      </fix>
      <fix>
      Add the catalina-optional JAR in the embed package (remm)
      </fix>
      <fix>
      Fix obscure JAXP related CL problem in embedded mode, by preloading some
      descriptors (remm)
      </fix>
      <fix>
      Release notes updates (funkman)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Catalina">

    <changelog>

      <update>
      Added Embedded.createConnector() methods that take address of type
      String (luehe)
      </update>
      <fix>
      Don't set the no-caching headers for protected POSTed pages.  This makes
      the "back" button in the browser works as expected. (billbarker)
      </fix>
      <fix>
      <bug>21341</bug>: Fix error page forwarding (remm)
      </fix>
      <fix>
      In the extended log valve, if bytes are requested, then print bytes, 
      not the date (funkman)
      </fix>
      <update>
      Add a Container.getPipeline() to allow bypassing the (useless) 
      invoke method (remm)
      </update>
      <add>
      Add code to allow printing partial stack traces for exceptions in HTML
      report pages, as well as add a note about the full stack trace of
      the root cause being available in the logs (remm)
      </add>
      <update>
      Logs will now contain the root cause of ServletExceptions (remm)
      </update>
      <fix>
      Fix a problem where the Strings weren't escaped in the same way for chars
      such as '. This caused problems for localization in French. (remm)
      </fix>
      <fix>
      Add leading + to timezone offset in the access logs (funkman)
      </fix>
      <update>
      Merge ErrorDispacherValve functionality back into StadardHostValve, and
      remove associated hacks from StandardServer and StandardHost (remm)
      </update>
      <fix>
      Like some of the other resources, application parameters must not be 
      reset on a context stop, as they come from a Context element. 
      Regular parameters read from web.xml should be fine. (remm)
      </fix>
      <fix>
      Correctly update the mapper. The previous code was not compatible with
      the invoker servlet and its dynamically added wrappers. (remm)
      </fix>
      <fix>
      Use the context logger for all webapp related error messages (remm)
      </fix>
      <update>
      Remove RequestListenerValve and merge it into StandardContextValve (remm)
      </update>
      <fix>
      Fix NPE exception when instances attribute is null (jfarcand)
      </fix>
      <fix>
      <bug>21822</bug>: Valves should only be registered and unregistered when:
      addValve or removeValve is called and the associated pipeline is started
      or on start and stop of the pipeline (remm)
      </fix>
      <update>
      Update security constraints processing to be compliant with the new
      behavior specified in the Servlet 2.4 specification, where security
      constraints must now be combined. <code>SecurityConstraint 
      Realm.findSecurityConstraint</code> is changed to
      <code>SecurityConstraint[] findSecurityConstraints</code>, and 
      implemented in RealmBase. (billbarker)
      </update>
      <fix>
      Fix problems updating a WAR for a context which had a context file
      (it would be ignored) (remm)
      </fix>
      <fix>
      Do not redeploy a context when a context file is added, and the 
      context wasn't deployed with the auto deployer (remm)
      </fix>
      <fix>
      The SetDocBaseRule will not throw a NPE, and will attempt to guess 
      the context docbase if not set (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Coyote">

    <changelog>

      <fix>
      Slight re-factoring of the JSSE SSL implementation to allow it to work 
      with non-Sun vendor's 1.4.x JVMs. (billbarker)
      </fix>
      <add>
      Added support for X-Powered-By response header, as defined by the
      Servlet 2.4 and JSP 2.0 specs (luehe)
      </add>
      <fix>
      Fix context removal from the mapper when Tomcat is used as embedded
      (jfarcand)
      </fix>
      <fix>
      As mandated by the specs, the mapper will always redirect for physical 
      directories, and will always process physical welcome files mapping
      (billbarker)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Jasper">

    <changelog>

      <fix>
      <bug>21753</bug>: Fix comment generation, submitted by Eric Carmichael
      (billbarker)
      </fix>
      <update>
      Hide all taglib and XML namespace management in PageInfo (luehe)
      </update>
      <fix>
      Forgive duplicate attribute values on static include (luehe)
      </fix>
      <fix>
      Fixed typos and formatting of JspC help message (luehe)
      </fix>
      <fix>
      Changed "jsp:usebean" to "jsp:useBean", submitted by Petr Jiricka (luehe)
      </fix>
      <update>
      Preparation work for new 'static include' rules (luehe)
      </update>
      <update>
      Ignore default settings for "extends" and "language" when checking for
      multiple page directive attributes with conflicting values (luehe)
      </update>
      <fix>
      Do not unconditionally use "JSP" as the default body-content type,
      because it is illegal for SimpleTag handlers (luehe)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Webapps">

    <changelog>

      <fix>
      Fix many tests (see bug <bug>21731</bug>), partially submitted by
      Peter Rossbach (remm)
      </fix>
      <docs>
      Added link to FAQ and Wiki on the introduction page of the docs (funkman)
      </docs>
      <docs>
      Update docs for AccessLogValve (funkman)
      </docs>
      <docs>
      Update docs index according to the menu changes (remm)
      </docs>
      <docs>
      Add some Windows setup documentation (remm)
      </docs>
      <update>
      Allow a WAR uploaded using the HTML manager to contain 
      a META-INF/context.xml context file, for consistency with the Ant deploy
      task (remm)
      </update>
      <fix>
      Remove work directory when undeploying a web application using the
      manager (remm)
      </fix>

    </changelog>

  </subsection>

</section>

<section name="Tomcat 5.0.4 (remm)">

  <subsection name="General">

    <changelog>

      <scode>
      <bug>19912</bug>, <bug>19939</bug>, <bug>19940</bug>, <bug>19941</bug>: 
      Many small typo fixes in resources, submitted by Chris Pepper (yoavs)
      </scode>
      <update>
      Upgrade to commons-fileupload 1.0 (remm)
      </update>
      <update>
      Upgrade to Struts 1.1 (remm)
      </update>
      <scode>
      Improve packaging to reduce total size of the Tomcat download (remm)
      </scode>

    </changelog>

  </subsection>

  <subsection name="Catalina">

    <changelog>

      <scode>
      Cleanup Catalina and subcomponents Javadoc generation (remm)
      </scode>
      <fix>
      Fix NPE in ApplicationHttpRequest when the object is created by a named 
      dispatcher (jfarcand)
      </fix>
      <fix>
      Escape '/' in the configFile name of a context, and strip out 
      leading '/' (remm)
      </fix>
      <fix>
      Initialize the context mapper after starting the context so that 
      the welcome files are correctly set (remm)
      </fix>
      <fix>
      <bug>19607</bug>: Remove Context XML descriptor on undeploy (remm)
      </fix>
      <update>
      <bug>4829</bug>: Improve deployer so that the unpackWARs flag value is
      respected regardless of how the context is deployed (remm)
      </update>
      <fix>
      If a context XML file is added for an existing context, or if the context
      XML file is updated, the context will be redeployed (remm)
      </fix>
      <update>
      Add logging on initialization of the URL stream handler (remm)
      </update>
      <fix>
      Add some Coyote inner classes to the preload list (jfarcand)
      </fix>
      <update>
      Remove session recycling, which was previously disabled after security
      concerns were raised (remm)
      </update>
      <update>
      Implement proper handling of the context docBase when it is deployed from
      a context XML descriptor, using a new custom digester rule (remm)
      </update>
      <fix>
      <bug>21419</bug>: Fix failure to start context when the Context element 
      is included in server.xml, submitted by Torsten Fohrer (remm)
      </fix>
      <fix>
      The pathinfo needs to be set in the ErrorDispatcherValve when 
      sreq.getAttribute(Globals.EXCEPTION_ATTR) returns null and also non null
      (jfarcand)
      </fix>
      <fix>
      <bug>21045</bug>: Update the message keys of the manager servlet (remm)
      </fix>
      <fix>
      In the manager servlet, use the configFile when undeploying, 
      to properly remove the config file even if it does not match the 
      context path (remm)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Coyote">

    <changelog>

      <fix>
      Allow '*' as a valid URL (keith)
      </fix>
      <add>
      Add support for enabling subset of supported SSL cipher suites (luehe)
      </add>
      <add>
      Add support for enabling subset of supported SSL cipher suites in JSSE 
      implementation (luehe)
      </add>
      <fix>
      Wrap encodeURL method call inside a doPrivileged block (jfarcand)
      </fix>
      <update>
      Add support for mapping host aliases (remm)
      </update>
      <update>
      <bug>21219</bug>: Close the HTTP connection after certain error codes, 
      or an unexpected exception, similar to HTTPd behavior (billbarker)
      </update>
      <add>
      Add support for enabling subset of supported SSL cipher suites 
      in PureTLS implementation (billbarker)
      </add>

    </changelog>

  </subsection>

  <subsection name="Jasper">

    <changelog>

      <fix>
      Improve web.xml insertion code so that the order of elements is respected
      (remm)
      </fix>
      <update>
      <bug>19622</bug>: Add encoding configuration to JspC (yoavs)
      </update>
      <fix>
      Remove comments generation when JspC is including mappings into web.xml,
      so that character coding issues are avoided (remm)
      </fix>
      <fix>
      Support regenerating the web.xml with JspC without manually removing the
      generated servlet mappings (remm)
      </fix>
      <update>
      Add detailed message about a likely Javac configuration problem whenever
      compilation fails and all messages and traces are empty (remm)
      </update>
      <fix>
      Allow the "value" attribute of &lt;jsp:param&gt; action to be non- 
      String types (kinman)
      </fix>
      <fix>
      Improve rare error message when static including fails (remm)
      </fix>
      <fix>
      <bug>21067</bug>: EL expression that returns an array causes 
      compilation error (kinman)
      </fix>
      <fix>
      <bug>21440</bug>: Partial fix for &lt;jsp:include&gt; whose target 
      performing a 'forward' does not behave as expected (luehe)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Webapps">

    <changelog>

      <fix>
      Remove parallel initialization of the admin webapp, which is not a best
      practice pattern (remm)
      </fix>
      <docs>
      Add deployer documentation (remm)
      </docs>
      <docs>
      Add some documentation on the JMXProxy servlet (funkman)
      </docs>
      <fix>
      Fix broken Javadocs links (remm)
      </fix>
      <update>
      Add a bugzilla query for all open TC 5 bugs, hoping people will help 
      address them (remm)
      </update>
      <docs>
      Update Host documentation based on the new and updated flags (remm)
      </docs>

    </changelog>

  </subsection>

</section>

<section name="Tomcat 5.0.3 (remm)">

  <subsection name="General">

    <changelog>

      <update>
      Upgrade to commons-el 1.0 (remm)
      </update>
      <update>
      Split main Catalina JAR, and move i18n related resource files to separate
      JARs (remm)
      </update>
      <fix>
      <bug>19808</bug>: Add the sit MIME mapping (funkman)
      </fix>
      <fix>
      <bug>20263</bug>: Fix problems running Tomcat with procrun as a Windows 
      service, submitted by Mladen Turk (remm)
      </fix>
      <update>
      Package Unix source from commons-daemon in the Tomcat distribution, so
      that the Unix wrapper can easily be used if needed (remm)
      </update>
      <update>
      Upgrade to commons-fileupload 1.0 RC 1, submitted by Martin Cooper 
      (billbarker)
      </update>
      <scode>
      Fix the netbuild (remm)
      </scode>
      <update>
      Specification schema changes, submitted by Mark Roth (kinman)
      </update>
      <update>
      Many tag handling specification clarifications, submitted by Mark Roth 
      (kinman)
      </update>

    </changelog>

  </subsection>

  <subsection name="Catalina">

    <changelog>

      <fix>
      Fix JMX registration order again during context startup: the object name
      is constructed before the pipeline initialization, but the JMX 
      registration only occurs after the context is started (remm)
      </fix>
      <fix>
      Properly close WARs after expanding them in the deployer (remm)
      </fix>
      <update>
      Fix handling of invalid WARs during auto deploy, which will be logged 
      as a simple WARN without a stack trace, and reattempt deployment later
      (remm)
      </update>
      <fix>
      Dig as deep as possible to display possible nesting of ServletExceptions
      (funkman)
      </fix>
      <fix>
      Fix NPE exception in classloader when an invalid war file is deployed
      (jfarcand)
      </fix>
      <fix>
      Container incorrectly processes invalid URL patterns in 
      jsp-property-groups (jfarcand)
      </fix>
      <add>
      Add optional XSL processing to the output of the default servlet, as well
      the ability to include a readme file, similar to Apache (funkman)
      </add>
      <scode>
      Remove bundled support for Tyrex (remm)
      </scode>
      <fix>
      Comment out invoker servlet declaration (remm)
      </fix>
      <update>
      Move context descriptors to $CATALINA_BASE/conf/[engine name]/[host name]
      to make the feature more secure (remm)
      </update>
      <update>
      Update the host properties: liveDeploy becomes autoDeploy (dynamically
      deploy and update web applications), and autoDeploy becomes 
      deployOnStartup (deploy webapps from appBase on startup) (remm)
      </update>
      <fix>
      Remove thread local caching in the default servlet, which was causing
      a memory leak (remm)
      </fix>
      <add>
      Add a mechanism to allow the classloader to release JAR file handles 
      periodically (remm)
      </add>
      <fix>
      <bug>20758</bug>: Remove a number of leaked references to the context
      object, so it can be properly garbage collected when the application
      is removed (remm)
      </fix>
      <fix>
      Do JMX registration of the context before starting the pipeline (remm)
      </fix>
      <update>
      Replace Catalina TLD-inside-JAR parsing code with a file based algorithm
      (remm)
      </update>
      <update>
      ServletContext.getResource for a JAR resource located inside /WEB-INF/lib
      will return a file based URL (remm)
      </update>
      <update>
      The special directories /WEB-INF/classes and /WEB-INF/lib are now 
      considered to be non cacheable, in order to conserve cache space (remm)
      </update>
      <fix>
      Clear out constructs used for classloading, after a class has been 
      successfully loaded (remm)
      </fix>
      <update>
      Generalize WAR unpacking, based on the unpackWARs flag (remm)
      </update>
      <update>
      Track WARs for changes when WARs are unpacked: if the WAR is updated
      the web application will be redeployed (remm)
      </update>
      <scode>
      Remove CertificatesValve, as it is useless with Coyote, and introduces
      a hard dependency on JSSE (billbarker)
      </scode>
      <update>
      Add caching mechanism for invocation of methods using privileged actions
      (jfarcand)
      </update>
      <fix>
      <bug>20380</bug>: AccessLogValve incorrectly calculates timezone, 
      <bug>16374</bug>: Date in file name configurable, <bug>16400</bug>:
      Allow logging to be conditional (funkman)
      </fix>
      <add>
      W3C Extended Log File Format support (funkman)
      </add>
      <update>
      Refactor FORM using a forward, based on the patch by Jeff Tulley (remm)
      </update>
      <fix>
      Properly set the wrapped request dispatcher state, submitted by Jan Luehe
      (remm)
      </fix>
      <update>
      Have all contexts inherit Embedded's logger (luehe)
      </update>
      <update>
      Add logging of unexpected exceptions occuring during reference resolution
      (remm)
      </update>
      <fix>
      unbindClassLoader was throwing NPE when newly added context 
      was removed (amyroh)
      </fix>
      <fix>
      Fix Gump failure by copying the Ant JAR manually (jfarcand)
      </fix>
      <update>
      Update confidential HTTPS redirection without using an actual URL,
      which has a hard JSSE dependency (remm)
      </update>
      <add>
      Include updated clustering code (fhanik, remm)
      </add>
      <update>
      Remove useless typecasts in the main processing pipeline, and make
      critical methods final, to enforce the Catalina design pattern (remm)
      </update>
      <update>
      Request dispatcher optimizations, based on the belief that wrapping 
      is only needed (if at all) for the special attributes (remm)
      </update>
      <update>
      Major filter mapping optimization, using simple String region matching,
      as well as synchronization removal (remm)
      </update>
      <add>
      Add new callback on the container interface to process any background
      task the container may have (backgroundProcess), as well as a new
      backgroundProcessor attribute (default value: 10s for the engine
      container, and -1 for all others, so that only the engine has an
      associated thread) (remm)
      </add>
      <add>
      Refactor application reloading, deployment handling and session 
      expiration to be able to use a single thread per Catalina engine, opposed
      to one thread per feature per webapp or virtual host; this should save
      resources and make Tomcat suitable for large scale web hosting; 
      individual containers can still "own" their own reloading thread 
      if they need to (remm)
      </add>
      <fix>
      Fix a bug where the context is not registered again in JMX after a 
      stop/start, which would break mapping (remm)
      </fix>
      <update>
      Implement context reloading as stop, followed by start, in an attempt
      to avoid code duplication and clear user confusion on what a reload 
      exactly does (remm)
      </update>
      <update>
      Pass the request URI as a parameter to the request dispatcher, as this 
      avoids rebuilding it (remm)
      </update>
      <fix>
      Unify the way we shutdown the server, and fix a classloading problem 
      when the digester files are under common/lib instead of server/lib 
      (jfarcand)
      </fix>
      <fix>
      Do not register a StandardContext instance when the context is stopped 
      (undeployed) (remm)
      </fix>
      <scode>
      Remove the old Catalina mapper (remm)
      </scode>
      <update>
      Switch to the "new" mapper for request dispatcher mapping (remm)
      </update>
      <fix>
      <bug>20018</bug>: ErrorPage directive doesn't work for HTTP error codes 
      (400,500,..) (remm)
      </fix>
      <update>
      Remove synchronized block on the request dispatcher wrapper request,
      submitted by Remy Maucherat (jfarcand)
      </update>
      <fix>
      Allow the getAttribute() method access to the wrapped request object 
      (like setAttribute/removeAttribute) (jfarcand)
      </fix>
      <update>
      Add the rest of missing attributes for j2eeType=WebModule and Servlet
      (amyroh)
      </update>
      <scode>
      Remove redundant commons-beanutils JAR (remm)
      </scode>
      <update>
      Isolate the validating digester creation so that the code can be reused
      (remm)
      </update>
      <fix>
      Fix to unregister valves that are other than Lifecycle 
      - RequestDumperValve (amyroh)
      </fix>
      <fix>
      Service.removeConnector doesn't unregister connector mbeans; call 
      connector.destroy to unregister (amyroh)
      </fix>
      <fix>
      Return null for objectName when initialization fails (amyroh)
      </fix>
      <update>
      Make objectName attribute visible for j2eeType=Servlet mbean (amyroh)
      </update>
      <fix>
      Register valve in JMX even if it's not an instance of Lifecycle (amyroh)
      </fix>
      <update>
      Add support for OS/400 in the Catalina shell scripts, submitted 
      by Robert Upshall (jfclere)
      </update>
      <fix>
      Improve logic for setWrapper call for privileged webapps (costin)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Coyote">

    <changelog>

      <fix>
      Fix access to the remote address of a request object with JMX (remm)
      </fix>
      <fix>
      Fix CLIENT-CERT authentication when using PureTLS (billbarker)
      </fix>
      <update>
      Allow setting arbitrary attributes on the HTTP/1.1 protocol handler
      (billbarker)
      </update>
      <update>
      Improve support for JSSE 1.1.x, and refactor introspection code in the
      factory (billbarker)
      </update>
      <fix>
      RFC 2109 cookies with quoted values are not processed properly (luehe)
      </fix>
      <fix>
      Check for the existence of the class before trying to load the JK adapter
      to avoid useless error logging (funkman)
      </fix>
      <fix>
      Fix the request state to allow the use of the request dispatcher from
      outside the filter pipeline (remm)
      </fix>
      <fix>
      Commit the response even if the buffer is empty when flushing (remm)
      </fix>
      <fix>
      ServletResponse.getLocale returns en_US instead of container (luehe)
      </fix>
      <fix>
      Filter out CRLF from the message text (remm)
      </fix>
      <update>
      Pass through all connector parameters to the Coyote protocol handler,
      which will allow custom initialization parameters for SSL, for example
      (billbarker)
      </update>
      <fix>
      Remove duplicate request field in the response object (remm)
      </fix>
      <fix>
      Correctly handle redirects sent by the mapper (remm)
      </fix>
      <fix>
      In the mapper, initialize the Context when the object is created (remm)
      </fix>
      <update>
      Add removeWrapper similar to addWrapper to the mapper (remm)
      </update>
      <update>
      Refactor very slightly the mapping algorithm and the mapper so that
      it can do context level mapping (remm)
      </update>
      <fix>
      <bug>19991</bug>: Make sure that the SSL-Cert Note gets recycled 
      before processing the request (billbarker)
      </fix>
      <fix>
      Changing to do lazy evaluation of the Servlet-Spec's SSL-attributes
      (billbarker)
      </fix>
      <fix>
      <bug>19958</bug>: IS.read() was actually accessing the char buffer, 
      instead of using the readByte method which correctly uses the byte buffer
      (remm)
      </fix>
      <fix>
      Get rid of the warning in the logs when no Client-Cert is available
      (jfarcand)
      </fix>
      <fix>
      Fix the server user-agent String to be compliant with the HTTP standard
      (remm)
      </fix>
      <update>
      Add new more explicit keep alive property based on the maxKeepAlive value
      (remm)
      </update>
      <fix>
      <bug>19904</bug>: Don't search the query-string or anchor-tag for 
      the protocol (billbarker)
      </fix>
      <fix>
      Robustness: catch exceptions which can occur in prepareRequest (remm)
      </fix>
      <fix>
      ServletResponse.getCharacterEncoding() doesn't return the value specified
      (luehe)
      </fix>
      <fix>
      Incorrect handling of ServletResponse.setLocale (luehe)
      </fix>
      <add>
      Add AOL Server support to JK 2, submitted by Alexander Leykekh (mturk)
      </add>
      <scode>
      Fix javadoc generation for the connectors (costin)
      </scode>

    </changelog>

  </subsection>

  <subsection name="Jasper">

    <changelog>

      <fix>
      <bug>20894</bug>: body-content value of "JSP" should be error 
      if SimpleTag (kinman)
      </fix>
      <fix>
      Switch back to JSPC forking being false by default (remm)
      </fix>
      <fix>
      Default Jasper to not using caches for opening JAR files, which prevents
      caching (and subsequent locking on Windows) at the JDK level (remm)
      </fix>
      <fix>
      Don't generate a smap for &lt;jsp:attribute&gt; itself, though maps are
      still generated for its body (kinman)
      </fix>
      <fix>
      In a template text, the chars after '$' are not handled correctly (kinman)
      </fix>
      <update>
      Only do the security init if there's a security manager (remm)
      </update>
      <fix>
      JSP caches tests failed - JSP compilation error (luehe)
      </fix>
      <fix>
      Close JARs after parsing their TLDs, regardless of whether the JAR
      contains any packaged tag files (luehe)
      </fix>
      <fix>
      In JspUtil, path is slash, even on windows (kinman)
      </fix>
      <fix>
      Expose root cause of ELExceptions when no error page is defined (luehe)
      </fix>
      <fix>
      Include &lt;jsp:param&gt; when checking if a page is scriptless, 
      submitted by Michael Walker (kinman)
      </fix>
      <fix>
      Set correct class path for tag files, submitted by Michael Walker 
      (kinman)
      </fix>
      <fix>
      EL evaluation error no longer discloses root cause (luehe)
      </fix>
      <fix>
      Exceptions not propagated to JSP error pages (luehe)
      </fix>
      <fix>
      Make sure that the output directory exist, in case it was removed 
      (kinman)
      </fix>
      <fix>
      'xmlns' attributes that do not represent tag libraries are subject 
      to TLD check (luehe)
      </fix>
      <fix>
      Jasper *always* passes initial response character encoding 
      to ServletResponse (luehe)
      </fix>
      <fix>
      <bug>19713</bug>: Define "request" the out of line method when there is
      a &lt;jsp:param&gt; in the body of a custom tag (kinman)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Webapps">

    <changelog>

      <update>
      Add placeholder code for a complete status display in the Status servlet,
      including webapps statistics (remm)
      </update>
      <fix>
      Fix WAR handling when deploying and undeploying webapps using the HTML
      manager (remm)
      </fix>
      <add>
      Add documentation on the default servlet (funkman)
      </add>
      <fix>
      Update information of the proxy documentation page (funkman)
      </fix>
      <update>
      Update the manager servlet to support versioning with the deploy method,
      in addition to other smaller refactorings (remm)
      </update>
      <add>
      Add changelog, status, and developers list (remm)
      </add>
      <update>
      Remove checkInterval attribute since it no longer exists (amyroh)
      </update>
      <fix>
      Use getSession(true) in the session example (remm)
      </fix>
      <update>
      Update documentation index, to reflect the docs structure (remm)
      </update>
      <fix>
      Disallow more than one SingleSignOn valve per service (amyroh)
      </fix>
      <fix>
      Unregister context and loader mbeans if it fails due to missing directory
      (amyroh)
      </fix>
      <fix>
      Fix to return an error page instead of error stack trace when a user 
      tries to create a context without creating a directory first (amyroh)
      </fix>
      <docs>
      Update manager documentation according to the new behavior (remm)
      </docs>
      <fix>
      Disable realm operations for engine until JAAS realm is supported 
      in admin (amyroh)
      </fix>
      <docs>
      Use a book-like structure for the user related documentation (remm)
      </docs>
      <docs>
      Add new deployer documentation (remm)
      </docs>
      <docs>
      Fix MySQL JDBC connection example (glenn)
      </docs>
      <fix>
      Add proper MIME types for the content the JSPX examples generate, 
      submitted by Mark Roth (kinman)
      </fix>

    </changelog>

  </subsection>

  <subsection name="Deployer">

    <changelog>

      <scode>
      Deprecate install and remove tasks (remm)
      </scode>
      <update>
      Add new properties to the deploy task to allow for versioning and
      updating (remm)
      </update>
      <add>
      Generate minimal catalina-deployer JAR for use with the deployer (remm)
      </add>
      <add>
      New validator task, for use with the deployer (remm)
      </add>
      <update>
      Rename deploy.xml to build.xml for ease of use (remm)
      </update>

    </changelog>

  </subsection>

</section>

<section name="Tomcat 4.1.7 Beta (remm)">

  <changelog>

    <scode>
    Tomcat 5.0.x branch point based on the Tomcat 4.1.7 codebase (remm)
    </scode>

  </changelog>

</section>

</body>
</document>
